{% extends "object_finder/base.html" %}

{% block content %}
<div class="container mt-5">
    <h2>{{ post.title }}</h2>
    <!-- Quill Viewer -->
    <div id="quill-viewer"></div>

    <!-- Display Comments -->
    <h3>Comments</h3>
    {% if comments %}
        {% for comment in comments %}
            <div class="comment mb-3">
                <p><strong>{{ comment.author.username }}</strong> on {{ comment.date_posted|date:"F j, Y, g:i a" }}</p>
                <p>{{ comment.content }}</p>
                <hr>
            </div>
        {% endfor %}
    {% else %}
        <p>No comments yet. Be the first to comment!</p>
    {% endif %}

    <!-- Comment Form -->
    {% if user.is_authenticated %}
        <h4>Leave a Comment</h4>
        <form method="post">
            {% csrf_token %}
            {{ comment_form.as_p }}
            <button type="submit" class="btn btn-primary">Submit Comment</button>
        </form>
    {% else %}
        <p>You must be <a href="{% url 'login' %}">logged in</a> to post a comment.</p>
    {% endif %}
</div>

<script>
    // Initialize Quill in read-only mode
    var quill = new Quill('#quill-viewer', {
        theme: 'snow',
        readOnly: true,
        modules: {
            toolbar: false
        }
    });

    var content_delta = {{ post.content_delta|safe }};
    quill.setContents(content_delta);
</script>
{% endblock content %}

